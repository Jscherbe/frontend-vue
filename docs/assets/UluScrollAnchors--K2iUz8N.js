import{S as _,N as U,D as y,ad as M,T as w,l as E,c as h,J as $,G as p,ae as x,d as z,e as B,o as C}from"./iframe-Dmbn_XAG.js";function D(e){var t;return e=e.replace(/^[^-_a-zA-Z]+/,"").replace(/^-(?:[-0-9]+)/,"-"),t=e&&e.replace(/[^-_a-zA-Z0-9]+/g,"-"),t.toLowerCase()}function L({sections:e,props:t,emit:a,componentElRef:u}){let n=null;function s(l){return e.value.findIndex(({element:v})=>l===v)}function o(l=null,v="down"){e.value.forEach(d=>{d!==l&&(d.active&&(d.inactiveFrom=v==="down"?"forward":"reverse",d.activeFrom=null),d.active=!1)})}function c(){let l=0,v=!0;const d=S=>{const{root:F}=n,A=F?F.scrollTop:document.documentElement.scrollTop||window.scrollY;if(t.debug&&(console.group("useScrollAnchors: onObserve"),console.log("Observer:",n),console.log("Last/Current Y:",`${l}/${A}`),console.log("Entries:",S.map(i=>({el:i.target,is:i.isIntersecting})))),v&&t.firstItemActive){t.debug&&console.log("Initial observation, respecting `firstItemActive`."),v=!1,l=A,t.debug&&console.groupEnd();return}v=!1;const f=A>l?"down":"up";l=A,t.debug&&console.log(`Scroll direction: ${f}`);const g=S.filter(i=>i.isIntersecting);if(t.debug&&console.log("Intersecting entries:",g.map(i=>i.target)),g.length>0){g.sort((m,O)=>s(m.target)-s(O.target));const i=f==="down"?g[g.length-1]:g[0];t.debug&&console.log("Chosen target entry:",i.target);const r=e.value[s(i.target)];r&&!r.active&&(t.debug&&console.log("Activating section:",r.title),w(()=>{o(r,f),r.active=!0,r.inactiveFrom=null,r.activeFrom=f==="down"?"forward":"reverse",a("section-change",{section:r,sections:e.value,active:!0})}))}else{t.debug&&console.log("No intersecting entries. Checking edge cases.");const i=e.value.find(r=>r.active);if(i){const r=S.find(m=>m.target===i.element);if(r&&!r.isIntersecting){const m=s(r.target),O=m===0,j=m===e.value.length-1;(O&&f==="up"&&!t.firstItemActive||j&&f==="down")&&(t.debug&&console.log("Deactivating section at edge:",i.title),w(()=>{o(null,f),a("section-change",{section:i,sections:e.value,active:!1})}))}}}t.debug&&console.groupEnd()};let b=null;t.observerOptions&&t.observerOptions.root?b=t.observerOptions.root:u.value&&(b=M(u.value),b===document.scrollingElement&&(b=null));const k={...t.observerOptions,root:b};n=new IntersectionObserver(d,k)}function I(){n&&(n.disconnect(),e.value.forEach(({element:l})=>{l&&n.observe(l)}))}function T(){n&&(n.disconnect(),n=null)}_(()=>{if(t.firstItemActive&&e.value.length>0){const l=e.value[0];l&&(l.active=!0)}c(),I()}),U(()=>{T()}),y(()=>e.value.length,()=>{w(()=>{I()})})}function Y(e){const t=E(null),a=p("uluScrollAnchorsRegister"),u=p("uluScrollAnchorsUnregister"),n=c=>`ulu-sa-${D(c)}`,s=h(()=>e.customTitleId||n(e.title)),o=$({id:Symbol("section-id"),title:e.title,titleId:s.value,element:null,active:!1,inactiveFrom:null,activeFrom:null});return y(()=>e.title,c=>{o.title=c,o.titleId=e.customTitleId||n(c)}),y(()=>e.customTitleId,c=>{o.titleId=c||n(e.title)}),_(()=>{a&&t.value&&(o.element=t.value,a(o))}),U(()=>{u&&u(o.id)}),{sectionRef:t,titleId:s,isActive:h(()=>o.active),inactiveFrom:h(()=>o.inactiveFrom),activeFrom:h(()=>o.activeFrom),section:o}}const N={__name:"UluScrollAnchors",props:{firstItemActive:Boolean,observerOptions:{type:Object,default:()=>({root:null,threshold:0,rootMargin:"-25% 0px -55% 0px"})},debug:Boolean},emits:["section-change"],setup(e,{emit:t}){const a=e,u=t,n=E([]),s=E(null);return L({sections:n,props:a,emit:u,componentElRef:s}),x("uluScrollAnchorsSections",h(()=>n.value)),x("uluScrollAnchorsRegister",o=>{n.value.push(o)}),x("uluScrollAnchorsUnregister",o=>{const c=n.value.findIndex(I=>I.id===o);c>-1&&n.value.splice(c,1)}),(o,c)=>(C(),z("div",{class:"scroll-anchors",ref_key:"componentEl",ref:s},[B(o.$slots,"default")],512))}};N.__docgenInfo={exportName:"default",displayName:"UluScrollAnchors",description:"",tags:{},props:[{name:"firstItemActive",description:"Make the first item active by default on load",type:{name:"boolean"}},{name:"observerOptions",description:`IntersectionObserver options
- Defaults: { root: null, threshold: 0, rootMargin: "-25% 0px -55% 0px" }
See: https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserver/IntersectionObserver`,type:{name:"object"},defaultValue:{func:!1,value:`{
  root: null,
  threshold: 0,
  rootMargin: "-25% 0px -55% 0px"
}`}},{name:"debug",description:"Enable debug logging for the IntersectionObserver",type:{name:"boolean"}}],events:[{name:"section-change"}],slots:[{name:"default"}],sourceFiles:["/Users/joescherben/Personal/Projects/ULU/frontend-vue/lib/components/systems/scroll-anchors/UluScrollAnchors.vue"]};export{N as _,Y as u};
